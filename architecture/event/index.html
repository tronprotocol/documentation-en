
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://tronprotocol.github.io/documentation-en/architecture/event/">
      
      
        <link rel="prev" href="../../using_javatron/private_network/">
      
      
        <link rel="next" href="../database/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.8">
    
    
      
        <title>Event Subscription - java-tron</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#event-subscription" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="java-tron" class="md-header__button md-logo" aria-label="java-tron" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            java-tron
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Event Subscription
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/tronprotocol/documentation-en" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="java-tron" class="md-nav__button md-logo" aria-label="java-tron" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    java-tron
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/tronprotocol/documentation-en" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Getting Started With java-tron
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started With java-tron
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/getting_started_with_javatron/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Using java-tron
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Using java-tron
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../using_javatron/installing_javatron/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deploying
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../using_javatron/backup_restore/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Backup and Restore
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../using_javatron/litefullnode/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lite FullNode
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../using_javatron/private_network/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Private Network
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Event Subscription
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Event Subscription
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item has-children">
  <a href="#local-event-plugin-subscription-recommended" class="md-nav__link" onclick="toggleChildren(event)" aria-expanded="false">
    <span class="md-ellipsis">
      Local Event Plugin Subscription (Recommended)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Local Event Plugin Subscription (Recommended)" hidden>
      <ul class="md-nav__list">
        
          <li class="md-nav__item ">
  <a href="#event-service-framework" class="md-nav__link" >
    <span class="md-ellipsis">
      Event Service Framework
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item ">
  <a href="#kafka-plugin-deployment-and-usage" class="md-nav__link" >
    <span class="md-ellipsis">
      Kafka Plugin: Deployment and Usage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item ">
  <a href="#mongodb-plugin-deployment-and-usage" class="md-nav__link" >
    <span class="md-ellipsis">
      MongoDB Plugin: Deployment and Usage
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item has-children">
  <a href="#built-in-message-queue-subscription-zeromq" class="md-nav__link" onclick="toggleChildren(event)" aria-expanded="false">
    <span class="md-ellipsis">
      Built-in Message Queue Subscription (ZeroMQ)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Built-in Message Queue Subscription (ZeroMQ)" hidden>
      <ul class="md-nav__list">
        
          <li class="md-nav__item ">
  <a href="#configuring-the-node" class="md-nav__link" >
    <span class="md-ellipsis">
      Configuring the Node
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item ">
  <a href="#starting-the-node" class="md-nav__link" >
    <span class="md-ellipsis">
      Starting the Node
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item ">
  <a href="#preparing-the-event-subscription-script" class="md-nav__link" >
    <span class="md-ellipsis">
      Preparing the Event Subscription Script
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item ">
  <a href="#starting-the-subscriber" class="md-nav__link" >
    <span class="md-ellipsis">
      Starting the Subscriber
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../database/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Database Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../using_javatron/connecting_to_tron/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Network Connection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../using_javatron/metrics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Node Monitoring
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../using_javatron/toolkit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Node Maintenance Tool
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/http/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTP API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/rpc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    gRPC API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/json-rpc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jsonRPC API
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Core Protocol
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Core Protocol
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mechanism-algorithm/dpos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DPoS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mechanism-algorithm/sr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Super Representative
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mechanism-algorithm/account/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Account Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mechanism-algorithm/resource/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Resource Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contracts/contract/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Smart Contract
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mechanism-algorithm/system-contracts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    System Contract
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mechanism-algorithm/dex/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Decentralized Exchange
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mechanism-algorithm/multi-signatures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Account Permission Management
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  <span class="md-ellipsis">
    For java-tron Developers
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            For java-tron Developers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/java-tron/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Developer Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/tips/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TIPs Workflow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/issue-workflow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Issue Workflow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/governance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Governance Workflow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/run-in-idea/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configure the IDE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/demo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Development Example
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/code-structure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Core Modules
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  <span class="md-ellipsis">
    For Dapp Developers
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            For Dapp Developers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contracts/tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tools
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Clients
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Clients
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../clients/wallet-cli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    wallet-cli
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Releases
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Releases
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../releases/upgrade-instruction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deployment Manual for the New Version
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../releases/signature_verification/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Integrity Check
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../releases/history/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    History
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Appendix
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Appendix
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glossary/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Glossary
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="event-subscription">Event Subscription<a class="headerlink" href="#event-subscription" title="Permanent link">&para;</a></h1>
<p>TRON provides a robust event subscription mechanism that allows developers to capture critical on-chain events in real-time. This includes transaction statuses, contract invocations, and block production, facilitating the development of feature-rich decentralized applications (dApps).</p>
<p>TRON offers two primary event subscription methods, allowing developers to choose based on their specific use cases:</p>
<ul>
<li><a href="#local-event-plugin-subscription-recommended">Local Event Plugin Subscription</a></li>
<li><a href="#built-in-message-queue-subscription-zeromq">Built-in Message Queue (ZeroMQ) Subscription</a></li>
</ul>
<h2 id="local-event-plugin-subscription-recommended">Local Event Plugin Subscription (Recommended)<a class="headerlink" href="#local-event-plugin-subscription-recommended" title="Permanent link">&para;</a></h2>
<p>This method utilizes an extensible plugin architecture to persistntly store on-chain events in external systems, such as <strong>MongoDB</strong> or <strong>Kafka</strong>, either in real-time or in batches. Designed specifically for production environments, this solution caters to applications requiring high reliability, durable storage, and robust data analysis capabilities.</p>
<p>This method has the following advantages:</p>
<ul>
<li><strong>Diverse Plugin Support:</strong> Currently supports Kafka and MongoDB.</li>
<li><strong>Rich Data Types</strong>: Enables subscriptions to blocks, transactions, smart contract events, and logs.</li>
<li><strong>Advanced Filtering</strong>: Supports filtering of events based on user-defined criteria.</li>
<li><strong>Historical Event Replay</strong>: The V2.0 framework allows syncing historical events from any specified block height.</li>
<li><strong>Production-Grade Reliability</strong>: Ideal for applications requiring high data integrity and dependability.</li>
</ul>
<h3 id="event-service-framework">Event Service Framework<a class="headerlink" href="#event-service-framework" title="Permanent link">&para;</a></h3>
<p>java-tron currently supports two versions of the event service framework: <code>V1.0</code> and <code>V2.0</code>.</p>
<ul>
<li><strong>V1.0</strong>: Only supports real-time event streaming for newly produced blocks.</li>
<li><strong>V2.0 (Recommended)</strong>:  Introduces a historical event replay feature, enabling synchronization from a specified block height.</li>
</ul>
<p>For a detailed comparison and guidance, refer to: <a href="https://medium.com/tronnetwork/event-service-framework-v2-0-0622f2f07249">Introduction to Event Service Framework V2.0</a>.</p>
<p><strong>Workflow of Event Service</strong>:</p>
<ol>
<li><strong>Event Capture</strong>: The TRON node extracts event data from on-chain blocks.</li>
<li><strong>Event Queuing</strong>: Events are encapsulated and added to a buffer queue.</li>
<li><strong>Plugin Consumption</strong>: The event plugin asynchronously consumes events from the queue.</li>
<li><strong>Event Delivery</strong>: The plugin pushes the processed data to the target system (e.g., Kafka or MongoDB).</li>
<li><strong>Application Logic</strong>: Downstream applications continuously process the event data.</li>
</ol>
<h4 id="how-to-migrate-to-event-service-framework-v20">How to Migrate to Event Service Framework V2.0<a class="headerlink" href="#how-to-migrate-to-event-service-framework-v20" title="Permanent link">&para;</a></h4>
<p>The <code>V2.0</code> event service framework introduces a historical event replay feature and includes comprehensive optimizations to the event push mechanism. This guide outlines the procedure for migrating to <code>V2.0</code>.</p>
<p><strong>Pre-Migration Considerations</strong></p>
<p>Before migrating, please consider the following factors:</p>
<ul>
<li>Internal Transaction Log Support: <code>V2.0</code> currently does not support internal transaction logs (the <code>internalTransactionList</code> field will be empty). If your application has a dependency on this field, you must remain on <code>V1.0</code>.</li>
<li>Plugin Version: We strongly recommend upgrading the event plugin to the latest version to prevent potential performance degradation when processing large volumes of historical data.</li>
</ul>
<p><strong>Migration Procedure</strong></p>
<h5 id="step-1-obtain-the-new-event-plugin">Step 1: Obtain the New Event Plugin<a class="headerlink" href="#step-1-obtain-the-new-event-plugin" title="Permanent link">&para;</a></h5>
<p>You can get the source code from GitHub and build it yourself, or download the officially released version directly.</p>
<ul>
<li>Build from Source:</li>
</ul>
<p><div class="highlight"><pre><span></span><code>git clone git@github.com:tronprotocol/event-plugin.git
cd event-plugin
git checkout master
./gradlew build
</code></pre></div>
After the build is complete, the generated <code>.zip</code> file is the plugin package.</p>
<ul>
<li>Download the Official Release:</li>
</ul>
<p>Visit the <a href="https://github.com/tronprotocol/event-plugin/releases">event-plugin Releases page</a> to download the latest plugin package.</p>
<h5 id="step-2-modify-the-fullnode-configuration">Step 2: Modify the FullNode Configuration<a class="headerlink" href="#step-2-modify-the-fullnode-configuration" title="Permanent link">&para;</a></h5>
<p>In your <code>config.conf</code> file, set the event service version to <code>V2.0</code>, the value is <code>1</code>.</p>
<div class="highlight"><pre><span></span><code>event.subscribe.version = 1 # 1 for V2.0，0 for V1.0
</code></pre></div>
<h5 id="step-3-configure-the-event-plugin">Step 3: Configure the Event Plugin<a class="headerlink" href="#step-3-configure-the-event-plugin" title="Permanent link">&para;</a></h5>
<p>The configuration process for the new plugin is mostly identical to the old version. You can refer to the official documentation for deployment:</p>
<ul>
<li><a href="#mongodb-plugin-deployment-and-usage">Deploying the Event Plugin (MongoDB)</a></li>
<li><a href="#kafka-plugin-deployment-and-usage">Deploying the Event Plugin (Kafka)</a></li>
</ul>
<h5 id="step-4-optional-configure-the-starting-point-for-historical-sync">Step 4 (Optional): Configure the Starting Point for Historical Sync<a class="headerlink" href="#step-4-optional-configure-the-starting-point-for-historical-sync" title="Permanent link">&para;</a></h5>
<p>If you need to sync historical events starting from a specific block height, add the following setting to your configuration file.</p>
<div class="highlight"><pre><span></span><code>event.subscribe.startSyncBlockNum = &lt;block_height&gt;
</code></pre></div>
<h5 id="step-5-start-the-fullnode-and-plugin">Step 5: Start the Fullnode and Plugin<a class="headerlink" href="#step-5-start-the-fullnode-and-plugin" title="Permanent link">&para;</a></h5>
<p>After completing the configuration, use the following command to start the <code>FullNode</code> and load the event plugin.</p>
<div class="highlight"><pre><span></span><code>java -jar FullNode.jar -c config.conf --es
</code></pre></div>
<h3 id="kafka-plugin-deployment-and-usage">Kafka Plugin: Deployment and Usage<a class="headerlink" href="#kafka-plugin-deployment-and-usage" title="Permanent link">&para;</a></h3>
<p>This guide is designed to help developers efficiently use the Kafka event subscription plugin to listen for on-chain events on the TRON network. We will walk you through the entire process step-by-step, from environment setup to deployment, configuration, and final verification.</p>
<p>The main steps include:</p>
<ul>
<li><a href="#recommended-system-configuration">Checking System Configuration</a></li>
<li><a href="#compiling-the-kafka-event-plugin">Compiling the Event Plugin</a></li>
<li><a href="#deploying-and-running-kafka">Deploying and Running Kafka</a></li>
<li><a href="#configuring-event-subscription">Configuring Event Subscription Rules</a></li>
<li><a href="#creating-a-kafka-subscription-topic">Creating the Kafka Subscription Topic</a></li>
<li><a href="#starting-the-event-subscription-node">Starting the Event Subscription Node</a></li>
</ul>
<h4 id="recommended-system-configuration">Recommended System Configuration<a class="headerlink" href="#recommended-system-configuration" title="Permanent link">&para;</a></h4>
<p>To ensure the stable operation of your TRON node and event subscription service, the following system configuration is recommended:</p>
<ul>
<li><strong>CPU</strong>: 16 cores or higher</li>
<li><strong>RAM</strong>: 32 GB or higher</li>
<li><strong>SSD</strong>: 2.5 TB or more of storage space</li>
<li><strong>Operating System</strong>: Linux or macOS</li>
</ul>
<h4 id="compiling-the-kafka-event-plugin">Compiling the Kafka Event Plugin<a class="headerlink" href="#compiling-the-kafka-event-plugin" title="Permanent link">&para;</a></h4>
<p>First, you need to clone the <code>event-plugin</code> project from its GitHub repository and compile it to generate the plugin's <code>.zip</code> file. Please follow these steps:</p>
<div class="highlight"><pre><span></span><code>git clone https://github.com/tronprotocol/event-plugin.git
cd event-plugin
./gradlew build
</code></pre></div>
<p>After a successful compilation, you will find the generated <code>.zip</code> plugin file in the <code>event-plugin/build/plugins/</code> directory, for example, <code>plugin-kafka-1.0.0.zip</code>.</p>
<h4 id="deploying-and-running-kafka">Deploying and Running Kafka<a class="headerlink" href="#deploying-and-running-kafka" title="Permanent link">&para;</a></h4>
<h5 id="step-1-installing-kafka">Step 1. Installing Kafka<a class="headerlink" href="#step-1-installing-kafka" title="Permanent link">&para;</a></h5>
<p>In a Linux environment, please follow these steps to install Kafka:</p>
<div class="highlight"><pre><span></span><code>cd /usr/local
wget https://downloads.apache.org/kafka/2.8.0/kafka_2.13-2.8.0.tgz
tar -xzf kafka_2.13-2.8.0.tgz
</code></pre></div>
<h5 id="step-2-running-kafka">Step 2: Running Kafka<a class="headerlink" href="#step-2-running-kafka" title="Permanent link">&para;</a></h5>
<p>In a Linux environment, please follow these steps to start the ZooKeeper and Kafka Broker services:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>/usr/local/kafka_2.13-2.8.0
<span class="c1"># Start the ZooKeeper service</span>
bin/zookeeper-server-start.sh<span class="w"> </span>config/zookeeper.properties<span class="w"> </span><span class="p">&amp;</span>
<span class="c1"># Start the Kafka Broker service</span>
bin/kafka-server-start.sh<span class="w"> </span>config/server.properties<span class="w"> </span><span class="p">&amp;</span>
</code></pre></div>
<h4 id="configuring-event-subscription">Configuring Event Subscription<a class="headerlink" href="#configuring-event-subscription" title="Permanent link">&para;</a></h4>
<p>To support Kafka event subscriptions, you need to modify the Fullnode's configuration file (<code>config.conf</code>) by adding the <code>event.subscribe</code> section.</p>
<div class="highlight"><pre><span></span><code>event.subscribe = {
  version = 1 
  startSyncBlockNum = 0 

  native = {
    useNativeQueue = false 
  }

  path = &quot;&quot; 
  server = &quot;&quot; 
  dbconfig = &quot;&quot; 
  contractParse = true
  topics = []
  filter = {}
}
</code></pre></div>
<p><strong>Field Descriptions</strong>:</p>
<ul>
<li><code>version</code>: The version of the event service framework. <code>1</code> indicates V2.0, while <code>0</code> indicates V1.0. If not configured, it defaults to V1.0.</li>
<li><code>startSyncBlockNum</code>: A new feature in v2.0 designed for historical data subscriptions. It allows the service to start processing and pushing events from a specific historical block height stored on the local node.<ul>
<li>If <code>startSyncBlockNum &lt;= 0</code>, this feature is disabled.</li>
<li>If <code>startSyncBlockNum &gt; 0</code>, this feature is enabled, and historical event synchronization will begin from the specified block height. <strong>Note</strong>: We recommend using the latest version of the event plugin when enabling this feature.</li>
</ul>
</li>
<li><code>native.useNativeQueue</code>: Specifies whether to use the built-in message queue (ZeroMQ) for event subscriptions. If you need to support Kafka event subscriptions, ensure this field is set to <code>false</code>; otherwise, Kafka subscriptions will not work.</li>
<li><code>path</code>: The absolute local path to the <code>plugin-kafka-1.0.0.zip</code> file. Please ensure the path is correct, or the plugin will fail to load.</li>
<li><code>server</code>: The Kafka server address in <code>ip:port</code> format. The default Kafka port is <code>9092</code>. Please ensure the port number is correct and that the Kafka service is accessible.</li>
<li><code>dbconfig</code>: This option is only for the MongoDB plugin and should be ignored for the Kafka plugin.</li>
<li><code>topics</code>: Configure the events to subscribe to. For more details, please refer to the <a href="#event-types">Event Types</a> section below.</li>
<li><code>filter</code>: Filtering parameters. For more details, please refer to the <a href="#event-types">Event Types</a> section below.</li>
</ul>
<h6 id="event-types">Event Types<a class="headerlink" href="#event-types" title="Permanent link">&para;</a></h6>
<p>TRON event subscription supports 7 types of events: <code>block</code>, <code>transaction</code>, <code>contractevent</code>, <code>contractlog</code>, <code>solidity</code>, <code>solidityevent</code>, and <code>soliditylog</code>. Developers should configure these based on their application's specific needs. <strong>We recommend subscribing to only 1-2 event types. Enabling too many triggers can lead to performance degradation.</strong></p>
<p><strong>1. Transaction Event</strong></p>
<p>Subscribes to events related to on-chain transactions.</p>
<p>Configuration Example：</p>
<p><div class="highlight"><pre><span></span><code>event.subscribe.topics = [
  {
    triggerName = &quot;transaction&quot;
    enable = false
    topic = &quot;transaction&quot;
    solidified = false
    ethCompatible = false
  }
]
</code></pre></div>
Parameters:</p>
<ul>
<li><code>triggerName</code>: (String) The event type identifier. For transaction events, this value is fixed to <code>transaction</code>.</li>
<li><code>enable</code>: (Boolean) Enables or disables the subscription for this event type.</li>
<li><code>topic</code>: (String) The name of the topic for receiving this event type in MongoDB or Kafka. This value must be consistent with the configuration in MongoDB or Kafka.</li>
<li><code>solidified</code>: (Boolean) If set to <code>true</code>, the subscription will only deliver events for transactions included in solidified blocks.</li>
<li><code>ethCompatible</code>: (Boolean) If set to <code>true</code>, the event payload will include Ethereum-compatible fields (e.g., <code>transactionIndex</code>, <code>logList</code>).</li>
</ul>
<p>Key Fields in Transaction Events:</p>
<ul>
<li><code>transactionId</code>: The transaction hash.</li>
<li><code>blockNumber</code>: The block height containing the transaction.</li>
<li><code>energyUsage</code>: The total amount of Energy consumed by the transaction.</li>
<li><code>energyFee</code>: The total amount of TRX (in sun) consumed by the transaction.</li>
</ul>
<p>For a complete list of fields, see the <a href="https://github.com/tronprotocol/java-tron/blob/develop/common/src/main/java/org/tron/common/logsfilter/trigger/TransactionLogTrigger.java">TransactionLogTrigger</a> source code.</p>
<p><strong>2. Block Events</strong></p>
<p>Subscribes to events triggered upon the creation of new blocks.</p>
<p>Configuration Example：</p>
<div class="highlight"><pre><span></span><code>event.subscribe.topics = [
  {
    triggerName = &quot;block&quot;
    enable = false
    topic = &quot;block&quot;
    solidified = false
  }
]
</code></pre></div>
<p>Key Fields in Block Events:</p>
<ul>
<li><code>blockHash</code>: The hash of the block.</li>
<li><code>blockNumber</code>: The block height.</li>
<li><code>transactionSize</code>: The total number of transactions included in the block.</li>
<li><code>latestSolidifiedBlockNumber</code>: The block number of the most recently solidified block at the time of this event.</li>
<li><code>transactionList</code>: An array of transaction hashes contained within the block.</li>
</ul>
<p>For a complete list of fields, see the <a href="https://github.com/tronprotocol/java-tron/blob/develop/common/src/main/java/org/tron/common/logsfilter/trigger/BlockLogTrigger.java">BlockLogTrigger</a> source code.</p>
<p><strong>3. Contract Events and Logs</strong></p>
<p>Subscribes to smart contract events and logs generated during contract execution.</p>
<p>Configuration Example：</p>
<div class="highlight"><pre><span></span><code>event.subscribe.topics = [
  {
    triggerName = &quot;contractevent&quot;
    enable = false
    topic = &quot;contractevent&quot;
  },
  {
    triggerName = &quot;contractlog&quot;
    enable = false
    topic = &quot;contractlog&quot;
  },
  {
    triggerName = &quot;solidityevent&quot;
    enable = false
    topic = &quot;solidityevent&quot;
  },
  {
    triggerName = &quot;soliditylog&quot;
    enable = false
    topic = &quot;soliditylog&quot;
  }
]
</code></pre></div>
<p>Parameters:</p>
<ul>
<li><code>contractevent</code>: Subscribes to all contract events from all blocks.</li>
<li><code>contractlog</code>: Subscribes to all contract logs from all blocks.</li>
<li><code>solidityevent</code>: Subscribes only to contract events from solidified blocks.</li>
<li><code>soliditylog</code>: Subscribes only to contract logs from solidified blocks.</li>
</ul>
<p>Key Fields in Contract Events</p>
<ul>
<li><code>transactionId</code>: The hash of the transaction that generated the event.</li>
<li><code>contractAddress</code>: The address of the smart contract.</li>
<li><code>blockNumber</code>: The block height at which the event was included.</li>
</ul>
<p>For a complete list of fields, see the <a href="https://github.com/tronprotocol/java-tron/blob/develop/common/src/main/java/org/tron/common/logsfilter/trigger/ContractEventTrigger.java">ContractEventTrigger</a> and <a href="https://github.com/tronprotocol/java-tron/blob/develop/common/src/main/java/org/tron/common/logsfilter/trigger/ContractLogTrigger.java">ContractLogTrigger</a> source code.</p>
<blockquote>
<p><strong>Note</strong>: <code>Contract event</code> and <code>Contract log</code> support event filtering through the <code>filter</code> field. You can specify a block range (<code>fromblock</code> - <code>toblock</code>), specific contract addresses (<code>contractAddress</code>), or specific contract topics (<code>contractTopic</code>) to provide developers with a more efficient and precise event subscription service.
<div class="highlight"><pre><span></span><code>filter = {
  fromblock = &quot;&quot; // The starting block number of the query range. Can be an empty string, &quot;earliest&quot;, or a specific block number.
  toblock = &quot;&quot; // The ending block number of the query range. Can be an empty string, &quot;latest&quot;, or a specific block number.
  contractAddress = [
    &quot;&quot; // The contract addresses you wish to subscribe to. If set to an empty string, logs/events from all contract addresses will be received.
  ]

  contractTopic = [
    &quot;&quot; // The contract topics you wish to subscribe to. If set to an empty string, logs/events for all contract topics will be received.
  ]
}
</code></pre></div></p>
</blockquote>
<p><strong>4. Solidified Block Notification Events</strong></p>
<p>Subscribes to real-time notifications for the latest solidified block height. This is ideal for applications that need to track the chain's finalized state.</p>
<p>Configuration Example：</p>
<div class="highlight"><pre><span></span><code>event.subscribe.topics = [
  {
    triggerName = &quot;solidity&quot;
    enable = true
    topic = &quot;solidity&quot;
  }
]
</code></pre></div>
<p>Key Fields in Solidity Notification Events:</p>
<ul>
<li><code>latestSolidifiedBlockNumber</code>: The block number of the newly solidified block.</li>
<li><code>timestamp</code>: The timestamp of the solidified block.</li>
</ul>
<p>For a complete list of fields, see the <a href="https://github.com/tronprotocol/java-tron/blob/develop/common/src/main/java/org/tron/common/logsfilter/trigger/SolidityTrigger.java">SolidityTrigger</a> source code.</p>
<h4 id="creating-a-kafka-subscription-topic">Creating a Kafka Subscription Topic<a class="headerlink" href="#creating-a-kafka-subscription-topic" title="Permanent link">&para;</a></h4>
<p>The name of the Kafka subscription topic must match the <code>topic</code> setting in the <code>topics</code> field of your <code>event.subscribe</code> configuration. For example, if you need to subscribe to <code>block</code> events and set the <code>topic</code> field in the <code>block</code> trigger to <code>"block"</code>, you must create a topic named <code>"block"</code> in Kafka to receive block events.</p>
<p>In a Linux environment, the command to create a Kafka topic is as follows:</p>
<div class="highlight"><pre><span></span><code>bin/kafka-topics.sh --create --topic block --bootstrap-server localhost:9092
</code></pre></div>
<h4 id="starting-the-event-subscription-node">Starting the Event Subscription Node<a class="headerlink" href="#starting-the-event-subscription-node" title="Permanent link">&para;</a></h4>
<p>After completing the above configuration, you must add the <code>--es</code> parameter when starting the FullNode to enable the event subscription feature.</p>
<div class="highlight"><pre><span></span><code>java -jar FullNode.jar -c config.conf --es
</code></pre></div>
<h5 id="verifying-plugin-load">Verifying Plugin Load<a class="headerlink" href="#verifying-plugin-load" title="Permanent link">&para;</a></h5>
<p>You can verify that the Kafka event plugin has loaded successfully by checking the Fullnode logs:</p>
<div class="highlight"><pre><span></span><code>grep -i eventplugin logs/tron.log
</code></pre></div>
<p>If you see a message similar to the following in the logs, the event subscription plugin has loaded successfully:</p>
<div class="highlight"><pre><span></span><code>[o.t.c.l.EventPluginLoader] &#39;your plugin path/plugin-kafka-1.0.0.zip&#39; loaded
</code></pre></div>
<h5 id="verifying-event-subscription">Verifying Event Subscription<a class="headerlink" href="#verifying-event-subscription" title="Permanent link">&para;</a></h5>
<p>Execute the <code>kafka-console-consumer.sh</code> script to retrieve messages from the <code>"block"</code> topic in Kafka to verify that the event subscription is successful.</p>
<p>In a Linux environment, the command is as follows:</p>
<div class="highlight"><pre><span></span><code>bin/kafka-console-consumer.sh --topic block --from-beginning --bootstrap-server localhost:9092
</code></pre></div>
<p>If you see JSON-formatted output similar to the following in your console, the event subscription is successful:</p>
<div class="highlight"><pre><span></span><code>{
    &quot;timeStamp&quot;: 1539973125000,
    &quot;triggerName&quot;: &quot;blockTrigger&quot;,
    &quot;blockNumber&quot;: 3341315,
    &quot;blockHash&quot;: &quot;000000000032fc03440362c3d42eb05e79e8a1aef77fe31c7879d23a750f2a31&quot;,
    &quot;transactionSize&quot;: 16,
    &quot;latestSolidifiedBlockNumber&quot;: 3341297,
    &quot;transactionList&quot;: [&quot;8757f846e541b51b5692a2370327f4b8031125f4557f8ad4b1037d4452616d39&quot;, &quot;f6adab7814b34e5e756170f93a31a0c3393c5d99eff11e30271916375adc7467&quot;, ..., &quot;89bcbcd063a48ef4a5678a033acf5edbb6b17419a3c91eb0479a3c8598774b43&quot;]
}
</code></pre></div>
<h3 id="mongodb-plugin-deployment-and-usage">MongoDB Plugin: Deployment and Usage<a class="headerlink" href="#mongodb-plugin-deployment-and-usage" title="Permanent link">&para;</a></h3>
<p>This guide is designed to help developers quickly deploy and use the TRON MongoDB event subscription plugin to achieve real-time data capture, persistent storage, and querying of on-chain events. The document covers the entire process, including system environment configuration, plugin deployment, database installation, query service setup, and API usage.</p>
<p>The main steps include:</p>
<ul>
<li><a href="#recommended-system-configuration_1">Checking System Configuration</a></li>
<li><a href="#system-architecture-and-workflow">Understanding the System Architecture</a></li>
<li><a href="#deploying-the-event-subscription-plugin">Deploying the Event Plugin</a></li>
<li><a href="#installing-and-configuring-mongodb">Deploying the MongoDB</a></li>
<li><a href="#deploying-the-event-query-service">Deploying the Event Query Service</a></li>
<li><a href="#launch-and-verification">Starting and Verifing</a></li>
<li><a href="#using-the-tron-event-query-service-api">Using the TRON Event Query Service API</a></li>
</ul>
<h4 id="recommended-system-configuration_1">Recommended System Configuration<a class="headerlink" href="#recommended-system-configuration_1" title="Permanent link">&para;</a></h4>
<p>To ensure the efficient and stable operation of your TRON node and event service, the following configuration is recommended:</p>
<ul>
<li><strong>CPU</strong>: 16 cores or more</li>
<li><strong>RAM</strong>: 32 GB or higher</li>
<li><strong>SSD</strong>: 2.5 TB or more</li>
<li><strong>Operating System</strong>: Linux or macOS</li>
</ul>
<h4 id="system-architecture-and-workflow">System Architecture and Workflow<a class="headerlink" href="#system-architecture-and-workflow" title="Permanent link">&para;</a></h4>
<p>The TRON MongoDB event subscription system consists of three core modules:</p>
<ol>
<li><strong>Event Subscription Plugin</strong>: Connects to a TRON node to capture event data and writes it to MongoDB.</li>
<li><strong>MongoDB Database</strong>: The persistence layer for storing event data.</li>
<li><strong>Event Query Service</strong>: Provides an HTTP API for external applications to query event data.</li>
</ol>
<h4 id="deploying-the-event-subscription-plugin">Deploying the Event Subscription Plugin<a class="headerlink" href="#deploying-the-event-subscription-plugin" title="Permanent link">&para;</a></h4>
<h5 id="1-building-the-plugin">1. Building the Plugin<a class="headerlink" href="#1-building-the-plugin" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>git clone https://github.com/tronprotocol/event-plugin.git
cd event-plugin
./gradlew build
</code></pre></div>
<p>After the build is complete, the generated plugin file will be located at:</p>
<div class="highlight"><pre><span></span><code>event-plugin/build/plugins/plugin-mongodb-*.zip
</code></pre></div>
<h5 id="2-configuring-the-fullnode">2. Configuring the FullNode<a class="headerlink" href="#2-configuring-the-fullnode" title="Permanent link">&para;</a></h5>
<p>Add the following content to your FullNode's configuration file, <code>config.conf</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nx">event</span><span class="p">.</span><span class="nx">subscribe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span><span class="w">  </span>
<span class="w">  </span><span class="nx">startSyncBlockNum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="w">  </span>

<span class="w">  </span><span class="kr">native</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">useNativeQueue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="w">  </span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="nx">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;/deploy/fullnode/event-plugin/build/plugins/plugin-mongodb-1.0.0.zip&quot;</span><span class="w">  </span>
<span class="w">  </span><span class="nx">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;127.0.0.1:27017&quot;</span><span class="w">  </span>
<span class="w">  </span><span class="nx">dbconfig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;eventlog|tron|123456&quot;</span><span class="w">  </span>
<span class="w">  </span><span class="nx">topics</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nx">triggerName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;block&quot;</span><span class="w">  </span>
<span class="w">      </span><span class="nx">enable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
<span class="w">      </span><span class="nx">topic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;block&quot;</span><span class="w">  </span>
<span class="w">      </span><span class="nx">solidified</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="w">  </span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nx">triggerName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;transaction&quot;</span>
<span class="w">      </span><span class="nx">enable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
<span class="w">      </span><span class="nx">topic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;transaction&quot;</span>
<span class="w">      </span><span class="nx">solidified</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
<span class="w">      </span><span class="nx">ethCompatible</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="w">  </span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nx">triggerName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;contractevent&quot;</span>
<span class="w">      </span><span class="nx">enable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
<span class="w">      </span><span class="nx">topic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;contractevent&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nx">triggerName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;contractlog&quot;</span>
<span class="w">      </span><span class="nx">enable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
<span class="w">      </span><span class="nx">topic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;contractlog&quot;</span>
<span class="w">      </span><span class="nx">redundancy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="w">  </span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nx">triggerName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;solidity&quot;</span>
<span class="w">      </span><span class="nx">enable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="w">  </span>
<span class="w">      </span><span class="nx">topic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;solidity&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nx">triggerName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;solidityevent&quot;</span>
<span class="w">      </span><span class="nx">enable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
<span class="w">      </span><span class="nx">topic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;solidityevent&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nx">triggerName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;soliditylog&quot;</span>
<span class="w">      </span><span class="nx">enable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
<span class="w">      </span><span class="nx">topic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;soliditylog&quot;</span>
<span class="w">      </span><span class="nx">redundancy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="w">  </span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>

<span class="w">  </span><span class="nx">filter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">fromblock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="w">  </span>
<span class="w">    </span><span class="nx">toblock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="w">  </span>
<span class="w">    </span><span class="nx">contractAddress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="w">    </span><span class="nx">contractTopic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Field Descriptions</strong>:</p>
<ul>
<li><code>version</code>: The version of the event service framework. <code>1</code> indicates V2.0, while <code>0</code> indicates V1.0. If not configured, it defaults to V1.0.</li>
<li><code>startSyncBlockNum</code>: A feature introduced in V2.0 that allows processing and pushing events from historical blocks, satisfying the need for historical data subscriptions. If <code>startSyncBlockNum &lt;= 0</code>, this feature is disabled. If <code>startSyncBlockNum &gt; 0</code>, the feature is enabled, and historical event synchronization will begin from the specified block height. <strong>Note</strong>: It is recommended to use the latest version of the event plugin when enabling this feature.</li>
<li><code>native.useNativeQueue</code>: Specifies whether to use the built-in message queue (ZeroMQ) for event subscriptions. <code>true</code> uses the built-in queue, while <code>false</code> uses the plugin. This must be set to <code>false</code>.</li>
<li><code>path</code>: The absolute path to the plugin file, e.g., <code>"/deploy/fullnode/event-plugin/build/plugins/plugin-mongodb-1.0.0.zip"</code>.</li>
<li><code>server</code>: The target server address, i.e., the address and port for MongoDB, e.g., <code>"127.0.0.1:27017"</code>.</li>
<li><code>dbconfig</code>: The MongoDB database configuration in the format: <code>database_name|username|password</code>, e.g., <code>"eventlog|tron|123456"</code>.</li>
<li><code>topics</code>: Seven event types are currently supported: <code>block</code>, <code>transaction</code>, <code>contractevent</code>, <code>contractlog</code>, <code>solidity</code>, <code>solidityevent</code>, and <code>soliditylog</code>. For more details, please refer to the <a href="#event-types">Event Types</a> chapter.<ul>
<li><code>triggerName</code>: The name of the trigger, which cannot be modified.</li>
<li><code>enable</code>: Toggles the event subscription. <code>true</code> enables it, <code>false</code> disables it.</li>
<li><code>topic</code>: The name of the collection in MongoDB that will receive the events. This can be modified.</li>
</ul>
</li>
<li><code>filter</code>: The criteria for filtering events.<ul>
<li><code>fromblock</code>: The starting block number of the query range. Can be <code>""</code>, <code>"earliest"</code> (to query from the genesis block), or a specific block number.</li>
<li><code>toblock</code>: The ending block number of the query range. Can be <code>""</code>, <code>"latest"</code> (the most recent block), or a specific block number.</li>
<li><code>contractAddress</code>: A list of contract addresses you wish to subscribe to. If set to an empty string, logs/events from all contract addresses will be received.</li>
<li><code>contractTopic</code>: A list of contract topics you wish to subscribe to. If set to an empty string, logs/events for all contract topics will be received.</li>
</ul>
</li>
</ul>
<h4 id="installing-and-configuring-mongodb">Installing and Configuring MongoDB<a class="headerlink" href="#installing-and-configuring-mongodb" title="Permanent link">&para;</a></h4>
<p>MongoDB will be used to store TRON event data. Please follow these steps to install and configure it:</p>
<h5 id="1-installing-mongodb">1. Installing MongoDB<a class="headerlink" href="#1-installing-mongodb" title="Permanent link">&para;</a></h5>
<p>First, create an installation directory for MongoDB, then download and extract the installation package:</p>
<div class="highlight"><pre><span></span><code>mkdir /home/java-tron
cd /home/java-tron
curl -O https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-4.0.4.tgz
tar zxvf mongodb-linux-x86_64-4.0.4.tgz
mv mongodb-linux-x86_64-4.0.4 mongodb
</code></pre></div>
<h5 id="2-setting-environment-variables">2. Setting Environment Variables<a class="headerlink" href="#2-setting-environment-variables" title="Permanent link">&para;</a></h5>
<p>To simplify subsequent operations, please set the environment variables for MongoDB:</p>
<div class="highlight"><pre><span></span><code>export MONGOPATH=/home/java-tron/mongodb/
export PATH=$PATH:$MONGOPATH/bin
</code></pre></div>
<h5 id="3-configuring-mongodb">3. Configuring MongoDB<a class="headerlink" href="#3-configuring-mongodb" title="Permanent link">&para;</a></h5>
<p>Create the log and data directories for MongoDB and create the configuration file <code>mgdb.conf</code>:</p>
<div class="highlight"><pre><span></span><code>mkdir -p /home/java-tron/mongodb/{log,data}
cd /home/java-tron/mongodb/log/ &amp;&amp; touch mongodb.log &amp;&amp; cd -
vim /home/java-tron/mongodb/mgdb.conf
</code></pre></div>
<p>Write the following content into the <code>mgdb.conf</code> file. Ensure that <code>dbpath</code> and <code>logpath</code> use absolute paths:</p>
<div class="highlight"><pre><span></span><code>dbpath=/home/java-tron/mongodb/data
logpath=/home/java-tron/mongodb/log/mongodb.log
port=27017
logappend=true
fork=true
bind_ip=0.0.0.0
auth=true
wiredTigerCacheSizeGB=2
</code></pre></div>
<p>Important Configuration Notes:</p>
<ul>
<li><code>bind_ip=0.0.0.0</code>: Must be configured to <code>0.0.0.0</code>; otherwise, remote connections will be rejected.</li>
<li><code>wiredTigerCacheSizeGB</code>: This parameter must be configured to prevent Out Of Memory (OOM) issues.</li>
</ul>
<h5 id="4-starting-mongodb">4. Starting MongoDB<a class="headerlink" href="#4-starting-mongodb" title="Permanent link">&para;</a></h5>
<p>Start the MongoDB service using the configuration file:</p>
<div class="highlight"><pre><span></span><code>mongod --config /home/java-tron/mongodb/mgdb.conf &amp;
</code></pre></div>
<h5 id="5-creating-admin-and-database-users">5. Creating Admin and Database Users<a class="headerlink" href="#5-creating-admin-and-database-users" title="Permanent link">&para;</a></h5>
<p>Connect to MongoDB to create an administrative user, then create the database and user for the event subscription service:</p>
<div class="highlight"><pre><span></span><code>mongo
use admin
db.createUser({user:&quot;&lt;admin-username&gt;&quot;,pwd:&quot;&lt;admin-password&gt;&quot;,roles:[{role:&quot;root&quot;,db:&quot;admin&quot;}]})

db.auth(&quot;&lt;admin-username&gt;&quot;, &quot;&lt;admin-password&gt;&quot;)
use eventlog
db.createUser({user:&quot;&lt;eventlog-username&gt;&quot;,pwd:&quot;&lt;eventlog-password&gt;&quot;,roles:[{role:&quot;dbOwner&quot;,db:&quot;eventlog&quot;}]})
</code></pre></div>
<h4 id="deploying-the-event-query-service">Deploying the Event Query Service<a class="headerlink" href="#deploying-the-event-query-service" title="Permanent link">&para;</a></h4>
<p>The Event Query Service provides an HTTP interface for querying event data stored in MongoDB. This service requires a Java environment.</p>
<p><strong>Note</strong>: Please use Oracle JDK 8 on x86 architecture and JDK 17 on ARM architecture.</p>
<h5 id="1-downloading-the-source-code">1. Downloading the Source Code<a class="headerlink" href="#1-downloading-the-source-code" title="Permanent link">&para;</a></h5>
<p>Clone the <code>tron-eventquery</code> project source code:</p>
<div class="highlight"><pre><span></span><code>git clone https://github.com/tronprotocol/tron-eventquery.git
cd tron-eventquery
</code></pre></div>
<h5 id="2-building-the-service">2. Building the Service<a class="headerlink" href="#2-building-the-service" title="Permanent link">&para;</a></h5>
<p>Download and use Maven to build the <code>tron-eventquery</code> service:</p>
<div class="highlight"><pre><span></span><code>wget https://mirrors.cnnic.cn/apache/maven/maven-3/3.5.4/binaries/apache-maven-3.5.4-bin.tar.gz --no-check-certificate
tar zxvf apache-maven-3.5.4-bin.tar.gz
export M2_HOME=$HOME/maven/apache-maven-3.5.4
export PATH=$PATH:$M2_HOME/bin
mvn --version
mvn package
</code></pre></div>
<p>Upon successful execution, a JAR package will be generated in the <code>tron-eventquery/target</code> directory, and a <code>config.conf</code> file will be created in the <code>tron-eventquery/</code> directory. An example of the configuration file content is shown below:</p>
<div class="highlight"><pre><span></span><code>mongo.host=IP
mongo.port=27017
mongo.dbname=eventlog
mongo.username=tron
mongo.password=123456
mongo.connectionsPerHost=8
mongo.threadsAllowedToBlockForConnectionMultiplier=4
</code></pre></div>
<p>Please modify <code>mongo.host</code>, <code>mongo.port</code>, <code>mongo.dbname</code>, <code>mongo.username</code>, and <code>mongo.password</code> according to your MongoDB configuration.</p>
<h5 id="3-starting-the-tron-event-query-service">3. Starting the TRON Event Query Service<a class="headerlink" href="#3-starting-the-tron-event-query-service" title="Permanent link">&para;</a></h5>
<p>Start the <code>tron-eventquery</code> service and insert the indexes:</p>
<div class="highlight"><pre><span></span><code>sh deploy.sh
sh insertIndex.sh
</code></pre></div>
<p><strong>Note</strong>: The default port is <code>8080</code>. To change it, edit the <code>deploy.sh</code> script. For example:</p>
<div class="highlight"><pre><span></span><code>nohup java -jar -Dserver.port=8081 target/troneventquery-1.0.0-SNAPSHOT.jar 2&gt;&amp;1 &amp;
</code></pre></div>
<h4 id="launch-and-verification">Launch and Verification<a class="headerlink" href="#launch-and-verification" title="Permanent link">&para;</a></h4>
<p>After completing the deployment steps, you can start the TRON FullNode and verify that the event subscription service is working correctly.</p>
<h5 id="1-starting-the-fullnode">1. Starting the FullNode<a class="headerlink" href="#1-starting-the-fullnode" title="Permanent link">&para;</a></h5>
<p><strong>Important</strong>: Before starting the FullNode, ensure that the MongoDB service has been started successfully.</p>
<p>The command to start the FullNode is as follows:</p>
<div class="highlight"><pre><span></span><code>java -jar FullNode.jar -c config.conf --es
</code></pre></div>
<p>For information on installing a FullNode, please refer to the <a href="https://tronprotocol.github.io/documentation-en/using_javatron/installing_javatron/">Deploying a FullNode</a> documentation.</p>
<h5 id="2-verifying-plugin-load">2. Verifying Plugin Load<a class="headerlink" href="#2-verifying-plugin-load" title="Permanent link">&para;</a></h5>
<p>You can verify that the event plugin has loaded successfully by checking the FullNode logs:</p>
<div class="highlight"><pre><span></span><code>tail -f logs/tron.log | grep -i eventplugin
</code></pre></div>
<p>If you see a message similar to the following, the plugin has loaded successfully:</p>
<div class="highlight"><pre><span></span><code>o.t.c.l.EventPluginLoader &#39;your plugin path/plugin-kafka-1.0.0.zip&#39; loaded
</code></pre></div>
<h5 id="3-verifying-data-persistence-in-mongodb">3. Verifying Data Persistence in MongoDB<a class="headerlink" href="#3-verifying-data-persistence-in-mongodb" title="Permanent link">&para;</a></h5>
<p>Connect to MongoDB and query the data to verify that event data has been captured from the node and stored in the database via the event subscription:</p>
<div class="highlight"><pre><span></span><code>mongo 47.90.245.68:27017
use eventlog
db.auth(&quot;tron&quot;, &quot;123456&quot;)
show collections
db.block.find()
</code></pre></div>
<p>If data is returned, it means the data has been stored successfully. Otherwise, please review the FullNode logs to troubleshoot the issue.</p>
<h4 id="using-the-tron-event-query-service-api">Using the TRON Event Query Service API<a class="headerlink" href="#using-the-tron-event-query-service-api" title="Permanent link">&para;</a></h4>
<p>The TRON Event Query Service provides a series of HTTP API endpoints for querying event data stored in MongoDB. For details on the specific APIs and their usage, please refer to the <a href="https://github.com/tronprotocol/tron-eventquery?tab=readme-ov-file#main-http-service">Event Query Service HTTP API documentation</a>.</p>
<h2 id="built-in-message-queue-subscription-zeromq">Built-in Message Queue Subscription (ZeroMQ)<a class="headerlink" href="#built-in-message-queue-subscription-zeromq" title="Permanent link">&para;</a></h2>
<p>The java-tron node includes a built-in <strong>ZeroMQ</strong> message queue that provides a lightweight event streaming service. This method requires no external plugins and is ideal for use cases that demand high real-time event delivery but do not require event persistence or historical replay, such as rapid prototyping and testing.</p>
<p>This method has the following advantages:</p>
<ul>
<li><strong>No Plugin Deployment</strong>: Subscriptions are established by connecting directly to a TRON node.</li>
<li><strong>Low Latency</strong>: Optimized for real-time event streaming.</li>
<li><strong>Lightweight</strong>: Well-suited for rapid development and testing environments.</li>
</ul>
<p>Therefore, when you want to connect to an event stream quickly and at a minimal cost without relying on persistence capabilities, using the <strong>built-in ZeroMQ message queue</strong> is a more lightweight and direct choice. This guide explains how to subscribe to events using this method.</p>
<h3 id="configuring-the-node">Configuring the Node<a class="headerlink" href="#configuring-the-node" title="Permanent link">&para;</a></h3>
<p>To enable event subscriptions via java-tron's built-in ZeroMQ, you must enable the feature in the node's configuration file.</p>
<div class="highlight"><pre><span></span><code>event.subscribe = {
  native = {
    useNativeQueue = true  
    bindport = 5555  
    sendqueuelength = 1000  
  }

  ......

  topics = [
    {
      triggerName = &quot;block&quot;  
      enable = true
      topic = &quot;block&quot;  
    },
    ......
  ]
}
</code></pre></div>
<ul>
<li><code>native.useNativeQueue</code>: <code>true</code> to use the built-in message queue, <code>false</code> to use event plugins.</li>
<li><code>native.bindport</code>: The port that the ZeroMQ publisher binds to. In this example, it is <code>5555</code>, so the subscriber should connect to the publisher address <code>"tcp://127.0.0.1:5555"</code>.</li>
<li><code>native.sendqueuelength</code>: The length of the send queue. This is the maximum number of messages the TCP buffer can hold if the subscriber is slow to receive them. Messages published beyond this limit will be discarded.</li>
<li><code>topics</code>: The subscribed <a href="#event-types">Event Types</a>, such as block types, transaction types, etc.</li>
</ul>
<h3 id="starting-the-node">Starting the Node<a class="headerlink" href="#starting-the-node" title="Permanent link">&para;</a></h3>
<p>The event subscription service is disabled by default and must be enabled using the <code>--es</code> command-line argument. The startup command for a node with event subscription enabled is as follows:</p>
<div class="highlight"><pre><span></span><code>$ java -jar FullNode.jar --es
</code></pre></div>
<h3 id="preparing-the-event-subscription-script">Preparing the Event Subscription Script<a class="headerlink" href="#preparing-the-event-subscription-script" title="Permanent link">&para;</a></h3>
<p>This guide uses Node.js as an example to demonstrate how to subscribe to events.</p>
<p>First, install the <code>ZeroMQ</code> library:</p>
<div class="highlight"><pre><span></span><code>$ npm install zeromq@5
</code></pre></div>
<p>Next, write the subscriber code:</p>
<div class="highlight"><pre><span></span><code>// subscriber.js
var zmq = require(&quot;zeromq&quot;),
var sock = zmq.socket(&quot;sub&quot;);

sock.connect(&quot;tcp://127.0.0.1:5555&quot;);
sock.subscribe(&quot;block&quot;);
console.log(&quot;Subscriber connected to port 5555&quot;);

sock.on(&quot;message&quot;, function(topic, message) {
  console.log(
    &quot;received a message related to:&quot;,
    Buffer.from(topic).toString(),
    &quot;, containing message:&quot;,
    Buffer.from(message).toString()
  );
});
</code></pre></div>
<p>This example connects the subscriber to the node's event publisher and subscribes to <code>block</code> events.</p>
<h3 id="starting-the-subscriber">Starting the Subscriber<a class="headerlink" href="#starting-the-subscriber" title="Permanent link">&para;</a></h3>
<p>The Node.js startup command is as follows:</p>
<div class="highlight"><pre><span></span><code>$ node subscriber.js

&gt; Subscriber connected to port 5555
</code></pre></div>
<p>When the node produces a new block, the subscriber will receive the block event, and the output will look like this:</p>
<div class="highlight"><pre><span></span><code>received a message related to: block, containing message: {&quot;timeStamp&quot;:1678343709000,&quot;triggerName&quot;:&quot;blockTrigger&quot;,&quot;blockNumber&quot;:1361,&quot;blockHash&quot;:&quot;00000000000005519b3995cd638753a862c812d1bda11de14bbfaa5ad3383280&quot;,&quot;transactionSize&quot;:0,&quot;latestSolidifiedBlockNumber&quot;:1361,&quot;transactionList&quot;:[]}
received a message related to: block, containing message: {&quot;timeStamp&quot;:1678343712000,&quot;triggerName&quot;:&quot;blockTrigger&quot;,&quot;blockNumber&quot;:1362,&quot;blockHash&quot;:&quot;0000000000000552d53d1bdd9929e4533a983f14df8931ee9b3bf6d6c74a47b0&quot;,&quot;transactionSize&quot;:0,&quot;latestSolidifiedBlockNumber&quot;:1362,&quot;transactionList&quot;:[]}
</code></pre></div>












		  <hr class="content-footer-divider">  <!-- 添加的水平线 -->
      	    	  <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../using_javatron/private_network/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Private Network">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Private Network
              </div>
            </div>
          </a>
        
        
          
          <a href="../database/" class="md-footer__link md-footer__link--next" aria-label="Next: Database Configuration">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Database Configuration
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <!--div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div-->
</footer>
                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.sections", "navigation.footer", "toc.integrate", "search.highlight", "search.suggest", "content.code.annotate", "content.tooltips"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../../javascripts/toc.js"></script>
      
        <script src="../../javascripts/nav-toc.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>